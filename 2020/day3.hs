{-# LANGUAGE TupleSections #-}
module Day3 where

inputData, inputDataTest :: [String]
inputDataTest = ["..##.......","#...#...#..",".#....#..#.","..#.#...#.#",".#...##..#.","..#.##.....",".#.#.#....#",".#........#","#.##...#...","#...##....#",".#..#...#.#"]
inputData = [".#......#..####.....#..#.......","#.#...#...#..#.#...#.#...##.##.","#.#....#..........#...##.....##","#.#.#.....##......#.#.......###","..#..###....#.#....#.#.#..#....",".......#.#....##..##...#...#...","..#..#..#..###.......#.....#.#.",".#.......#...##...##.##......##","#.#.##..##.#..#....#..###..#.#.","#.....#.#.........#.....##.#.#.","..#.#....##..#...#...##........","......#....#..##.#.#......###..",".......#.......#......##...#...",".##.....#.......#...###.....##.",".#...#.##..##.#..##....#.......","..#......##...#..#...#.#.##.###",".##.##.....##....#..#......#.#.",".#.....#..###..#.##.#.....##.#.","......##..........#..........#.",".##....#.....#..##.#..#.#..###.","..##.......#....#...##...#..#..",".##...#.....#.###.#.#..#...#.#.",".....##.#.##..##...#...........","..#..###.##.#.#.###...###..#.#.",".#........#..#.#........#.#...#","....##.......#....#.#.##.#.....","....##........######..###..#.#.","#.#.#............#.......#..#..","...##...#.##.....#.#..#......#.","......#.##.#....##..#.#..###...","##.....#.#....#....#.##.#.###..","#..#..#..##.#..##.##.##.#.##...",".###.####..#..#........#.....##",".......##..#.......#...........",".##...#............#.#.##...#..","....##.....#...##..#..#.#..###.","...#.....#####.#..#...##....##.","#.....#.#.#....##.......##.#.#.","......#.#..#.##.#######......#.","#.##...##....#..###.#.......#..",".....##...#....#...#....##.##.#","....###......#...###..#......##","..#...##..##.######..#.#......#","......##....#....##..#......##.",".#...#..##..#.###.#......#....#","##....##..#..####.#.....#...#..",".#.......#...#.......##......#.","......#...#...#........#.......",".#........#.###...#..####.#..#.","##...#.#............#.....###..",".....###.#.##...........###..#.",".#.#...#.....#.#.##..##...####.","..##.......#..#.##.#....#.....#",".#..#.#..####.....###.#.....#..","..#..###.....####..#.##.#.#.##.",".###..#.....#......#...####....","...#.#..#.#..#...#...#....##.##","..###....#.##.....#..........#.","###...#####......##............","..###.....#........##.#...#..#.","..##.##.#.....##........##..#.#","##..#.#...#.#..#..###.#....#..#","....#..#.#.....#..#####...#....","....#.........#......##.##.....",".#...####.##......##..##.#..#.#","...#...#.##..#...##..###...#...","###...#.....#.##.###.###..#.#..","..#......#.###.....#..##.#...#.","#.....##.########...#####....#.","........##..#..##..##.#........","....#.######....##..#..#.##..#.","#.......#..##..#..#.#.#..##.##.","...#.#..#..#.......#......###.#",".#.#..#.#..#.##.#.............#","#....#.##.#.#.....#..#.#..#....","...###..#...#....#.........#.#.",".#..#.....##..#.#..#.#.......#.","..#...##...#......#......####..","....#..#.......#.......#.#..#..","#...#..#...........#.#..#.....#","#...#.#.......#...#....###....#",".#..#.#.##....#......#........#","..#...#..##..#..#..#..#...#.#..","..#.#.........#....#....##.....","##.....##.#.#.#.........##.....",".##...#.##...........#...#...##",".##..##.#.#..........##..##....","#....#....#.#...#.#..#....#.#..","####....##.....#..##.###.......","#..#....#......##.#.#....#.....",".....#....#.###.##.........###.","#.......#.####..#..#..##.......","##.#.......#..##..#....#..#.#..","..###...#.#...#.....##.##.####.","....#...#.#....#..#..#.....#.##","#.....##.#.#..#.##..#..##......","................###..#....##...","..#.##.....#..........##.#...#.","..#.#..#.#....#.#.#..#..#..#.#.","#...#..##.#.#...#..#...#..#....","#..#.#.........#..###........#.",".#...#.............#..###..#..#","#.........#.#..#...#.#.....#..#","....#..#..#.#.#...#...#.....##.","##...###.#.####..#......#...#..","..#..##...#.#......#.#.......#.","#......###....##.#.##..........","#####....###..#...............#","##.#...####....#....#...#....#.",".#.......#..#.....#...#.....###","...#..#.#.#....##......##...#..","...#.....#...#.##.#..#.#....#..","#...###....#...#.#....#........",".#.......#........#...##.##.##.",".....#....#...##.....##...###.#","....#....#.#..#...##.##.##.....",".......#............#...#.#..#.",".#............#.....##.......#.","........#....#....##......##.##",".......##..#.#..#.##..###..##.#","#..##..##.........####.#.###...","#....#..#...##...#.............","#...#...###..........##..#..#..","....#...#..#.....##...#........","#.....#......#.#.....#...#..#..","..#.....#.....#....#..#........","..#..#.....#.#.........#..###..","................###..#.#....#..","#.....#.....#.#.#.#.#..#...#.#.","#....#....#.#..........#.#....#","....#..#......#..##.#...##.....","..#.#...#.####....#.#..#.#..#..",".........##......#.....##......","##.#.###.#.....#.....####.#..#.",".....#.....#..#....#..###.#....","##..#.#...#.##....#....#.......",".....#......#.#...##..#.#......","....##..#...#...##..##.#....#.#","............#..........##.#....","##..#..#.##..##..#.#....#.#.#..",".......#.#...#...#.#...#..#....","#....#.#...#...#........#..#...","...........#.......#...##..###.",".#..##......#.##.........##..#.","...#...#...###.#.##....##.#..#.","#...#..#.#.#.....##..#.......#.",".##..#.###.##......#.#....#.#.#","..#....#.......#..#..#.#.#.##..","#...#...###...###.........#....",".#.#...#.....##.#.#..#....#.##.",".........#.#.##.....#.#.###....","...#.#...#......#...####......#","...##..##....##......##...###..","###...#..#.......##.....#....#.","...#..#..#..###...##.##..#..#..","...#......#......##..#.#.##..#.","...#.........#....#.#....#.#...","##................#..#.#.....#.","....#.##...#..#.##...##.#.....#","......#..##.##..###.#..#.##.##.",".#.#...###.....###.....##...###",".##.....#.#.#..#..###..#..#..#.","#.......#..#..#....##.....#....","...#.#.##..#..#......##.##...#.","....##.#......#...#..#..#......",".####.#..#.....#..##.#...##..##","..#..#...#..........###..#....#",".#.#.##.##...#............#....","........##..##......#.##..#.###","...#.#....###......##.......#..","..##...#...#.#..#.....#.....#..","##..#...###..#..#.#.#...#...#..",".....#..#....##.....##.....###.","....##...###.#..#.#....##..#..#","#......#...#....#......#...##..","....#.##...#.#......#.#.##...#.",".......#.....#...#####...#.#...","...#.....##.#............#.....","...#.#........#.#.#..#.........","....###......#.#.#..#.####.#..#","#.....#.#.#.....#.#.#.....#..#.","..##.##......#...#.#...........","###..###....#.#####......###...","..##..............##.#.#....#.#","#..#...#..........#..#.#.#..###","##.###............#....#.#...#.","#.#..#.#..##.#.#....#...#......","#....#...#..##.....#..#.#..###.","..#.....#.#....#.#..#.##.#..##.","...##...#.#.##...#....###....#.","......###.####.......#..#.#.#.#",".#..............##........#....","...##.##...##....#..#.......#..",".....#.....#....###...#..#..#.#",".#.....#..#.....#......#.....##","#.#.##.#..#..#.....#.##..###...","..#......#...##.###..#.#...#..#","......#.....#...##......#......","##.#........#..........#.....#.","#........##.#............##....","...#......##...#.#.....##......","...##.......#....#.#..#.#.###..","..#....##..##.##.....###....#..","..#...#.#...#.....#..........#.","......#...#...#.#.##.#...#.#.#.",".#...#......#.##........#......",".##.##..#....#...#.#...##......","#..#......#.#...........#....#.","....##.#....#...#..#....#.#..##","#....##.##....#.#..##.#........",".##.##.#....##.....#..#....#..#","...#...#.....###.#.##..........","....#...#....##.......###......","#.........#......#.#.......#...","#..........#..##..#.#..........",".....#.......#..##.##....##...#","........................#.#....","#..#.........#.............#..#","#..#.....#.......#....#....#.#.","..##..##.......##....#...#.....",".##......#..##......#.###......","...#.#........#.......##..###..","..##...###.###......#...#....##","#...#...#.....###.#.#.#..#.....","#....#.........#..##...#...##..","#..###..#.#.#.##.#..#.#....#.##","#...#.#.....#.###.#.......#....","..##..#..#....#.#...........#.#","#.........#.#......#...##......",".######......#..#....#.#.#....#","##..#.#..####.###.........#....","###########.....##.##...#..#...","#...##.#.#....#.#....#......#..","...#..##..#..##..#......#....#.",".#....#...#....#.#..##....##...","#..#.#............#....#.#...#.","...#...#..#.#.##......#..#.#...","#.#...##.....#..#.##......####.",".#.#..##..#.....#.#..#.##......","#.#.##......##.....#..#.#..#...","#..##...#.##.#.......#.##......","..#.......#.#.#...##..##...#...",".#...#..#..#.#.........#..##...","#..#.......#....#.#...#.###...#",".......#..#.......##.#.#...#.#.",".#.................###.#..###..","..........#.#.....##..#####...#","#......#.#..##.#.#...#.##.#....","#......#.#..##.##.#...#....#...","....#..#......#....#....#######",".#...#......#....###......#.###","#.#....#.#...#.###......#..#..#",".###......#.#...#.####.#..####.","######.#.....###.#...#.#.....#.",".#.###....#..#.#.....#.....####",".......###.#.........#..#......","#...#.....##.#......####.......","..#.#..##.#.#...#...#..##..##..",".....#...##.....#...##......##.","##..#..#.##..#.#......#.....#..","##.........#.#.##.#..#.#....#.#",".#........###...#.........#....","...#..#.#..#....####...........","#.#....#..##..####.#...#.##....",".#.....#.......#..........#..##","...#.......#...###..#.....#..##",".........#.###.#..##...#.##...#",".#..........##..####...#..#.#.#",".#...##...#............##...#.#","...#....#.#..........#.#..#.#..",".#.#...##....##.#.#.#....#.....","....#..#.....#.#..#.#..#.##.###",".....#.#.....#..#......#.#.#...",".....#.#.#..###..#.#..###...#..","#.......####...#.#..#......##.#","....#..#..###......###.##....#.","##.....#.....#.............#..#","#..#..#...##.....##..#..#.#....",".....#.#.###...#...............","#.#.#.....#.#..#.#...#.......#.","..##.##............#....#..##..","#....##...#.....#.###...#.#....","#...##.#.........#...#....#....","##.##.#...#.#...###..#....##..#","....#....##..#..#.......#...##.",".#...#...#..#.....#..###.#..#.#","....#..###......#....##....#...","#.#.....#....##.#..#.#...###...",".......#............#......#...",".##..#.###.#.............###...","..##...##.#.#.#.....#........##","....#.###....#..#..#...#...#..#",".....#...#...#..#....#.....##..","###.#.#.....#......####.....#..","#.#.###............#......#....","..#.....#..#..#..#....#......#.","#...######...#....#.##...##.#.#","##.#.#.#..##......##.#..#.#...#","............#.#..#.##....#.....","......#............#.#...#..#.#",".#..##...##..#.#.#..###.....##.","#.###.#...........#...#....#...","....##.....#...##...#...###.#.#",".####.#.#.....#.#..#.#.##......",".#...##......###...#..##..#.#..",".#......#...#....##.....##..#..","..........##.....###.##.#...#.#",".#........##.#..............#..","#...###..#...#.....#....#.....#","...#......#..#...#...#..###.#..",".#...##..#........#.......#.#..",".#.#.##.........##.##......#..#","#...#.#.#...#.....#.#...#.#..#.","#.#..#...#...#...##..........#.",".#...........#....#..#.#..#.#..","#.......#......#..#...#........",".....#..#...##..###..##........","......#...#.....#..#.#.#....##.","....##..##..##....###.##.......",".#........##.#.#...#..#........",".....##...##...#......#..#...#.","..#.....#....###.#..##....#..#.","......#..#...####.#.....##.####"]

getXCoords :: String -> [Int]
getXCoords line = getXCoords' line 0

getXCoords' :: String -> Int -> [Int]
getXCoords' (x:xs) i | x == '#' = i : getXCoords' xs (i+1)
                     | otherwise =  getXCoords' xs (i+1)
getXCoords' [] _ = []

addYCoords :: Int -> [Int] -> [(Int, Int)]
addYCoords y = map (,y)

xCoords ::[String] ->  [[Int]]
xCoords = map getXCoords

getMap :: [String] -> [(Int, Int)]
getMap input = concat $ zipWith addYCoords [0..(length (xCoords input))] (xCoords input)

getPath :: Int -> Int -> Int -> Int -> [(Int,Int)]
getPath dx dy l h = map (\y -> (y*dx`mod`l,y*dy))  [0..h]

getTreesOnSlope :: Int -> Int -> [String] -> Int
getTreesOnSlope dx dy input = length $ filter (`elem` m) path
    where path = getPath dx dy (length (head input)) (length input) 
          m = getMap input 

part1 :: Int
part1 = getTreesOnSlope 3 1 inputData
part2 = getTreesOnSlope 1 1 inputData * getTreesOnSlope 3 1 inputData * getTreesOnSlope 5 1 inputData * getTreesOnSlope 7 1 inputData * getTreesOnSlope 1 2 inputData

